<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Mapping Tool</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .card {
            transition: transform 0.2s;
            margin-bottom: 1rem;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .result-area {
            max-height: 400px;
            overflow-y: auto;
            background-color: #f8f9fa;
            padding: 1rem;
            border-radius: 0.25rem;
            margin-top: 1rem;
        }
        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }
        .form-group {
            margin-bottom: 1rem;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container py-5">
        <h1 class="text-center mb-5">Network Mapping Tool</h1>

        <!-- System Setup -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h5 class="card-title mb-0"><i class="fas fa-cogs me-2"></i>System Setup</h5>
            </div>
            <div class="card-body">
                <button class="btn btn-info" onclick="installRequirements()">
                    <i class="fas fa-download me-2"></i>Install Required Packages
                </button>
            </div>
        </div>

        <div class="row">
            <!-- Network Information -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="card-title mb-0"><i class="fas fa-network-wired me-2"></i>Network Information</h5>
                    </div>
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <button class="btn btn-outline-primary" onclick="getInfo('local-ip')">
                                <i class="fas fa-laptop me-2"></i>Get Local IP
                            </button>
                            <button class="btn btn-outline-primary" onclick="getInfo('mac-address')">
                                <i class="fas fa-id-card me-2"></i>Get MAC Address
                            </button>
                            <button class="btn btn-outline-primary" onclick="getInfo('router-details')">
                                <i class="fas fa-router me-2"></i>Get Router Details
                            </button>
                            <button class="btn btn-outline-primary" onclick="getInfo('isp-info')">
                                <i class="fas fa-globe me-2"></i>Get ISP Information
                            </button>
                            <button class="btn btn-outline-primary" onclick="getInfo('connected-devices')">
                                <i class="fas fa-users me-2"></i>Get Connected Devices
                            </button>
                            <button class="btn btn-outline-primary" onclick="getInfo('connection-type')">
                                <i class="fas fa-wifi me-2"></i>Get Connection Type
                            </button>
                            <button class="btn btn-outline-primary" onclick="getInfo('check-anonymity')">
                                <i class="fas fa-user-secret me-2"></i>Check Anonymity
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- System Information -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h5 class="card-title mb-0"><i class="fas fa-desktop me-2"></i>System Information</h5>
                    </div>
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <button class="btn btn-outline-success" onclick="getInfo('system-info')">
                                <i class="fas fa-info-circle me-2"></i>Get System Information
                            </button>
                            <button class="btn btn-outline-success" onclick="getInfo('network-stats')">
                                <i class="fas fa-chart-line me-2"></i>Get Network Statistics
                            </button>
                            <button class="btn btn-outline-success" onclick="getInfo('disk-usage')">
                                <i class="fas fa-hdd me-2"></i>Get Disk Usage
                            </button>
                            <button class="btn btn-outline-success" onclick="getInfo('cpu-usage')">
                                <i class="fas fa-microchip me-2"></i>Monitor CPU Usage
                            </button>
                            <button class="btn btn-outline-success" onclick="getInfo('auth-logs')">
                                <i class="fas fa-shield-alt me-2"></i>Parse Authentication Logs
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Advanced Scanning -->
        <div class="card mt-4">
            <div class="card-header bg-warning text-dark">
                <h5 class="card-title mb-0"><i class="fas fa-search me-2"></i>Advanced Scanning</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6>Target Scan</h6>
                        <div class="form-group">
                            <input type="text" id="scanTarget" class="form-control" placeholder="Enter target IP or domain">
                        </div>
                        <button class="btn btn-warning" onclick="scanTarget()">
                            <i class="fas fa-search me-2"></i>Scan Target
                        </button>
                    </div>
                    <div class="col-md-6">
                        <h6>SSH Connection</h6>
                        <div class="form-group">
                            <input type="text" id="sshHost" class="form-control mb-2" placeholder="Hostname">
                            <input type="text" id="sshUser" class="form-control mb-2" placeholder="Username">
                            <input type="password" id="sshPass" class="form-control mb-2" placeholder="Password">
                            <input type="text" id="sshKey" class="form-control mb-2" placeholder="Key file path (optional)">
                        </div>
                        <button class="btn btn-warning" onclick="sshConnect()">
                            <i class="fas fa-terminal me-2"></i>Connect SSH
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Area -->
        <div class="card mt-4">
            <div class="card-header bg-secondary text-white">
                <h5 class="card-title mb-0"><i class="fas fa-terminal me-2"></i>Results</h5>
            </div>
            <div class="card-body">
                <div class="loading">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
                <div id="result" class="result-area"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        async function getInfo(type) {
            const resultArea = document.getElementById('result');
            const loading = document.querySelector('.loading');

            loading.style.display = 'block';
            resultArea.innerHTML = '';

            try {
                const response = await fetch(`/api/${type}`);
                const data = await response.json();

                if (typeof data === 'object') {
                    resultArea.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
                } else {
                    resultArea.innerHTML = `<pre>${data}</pre>`;
                }
            } catch (error) {
                resultArea.innerHTML = `<div class="alert alert-danger">Error: ${error.message}</div>`;
            } finally {
                loading.style.display = 'none';
            }
        }

        async function installRequirements() {
            const resultArea = document.getElementById('result');
            const loading = document.querySelector('.loading');

            loading.style.display = 'block';
            resultArea.innerHTML = '';

            try {
                const response = await fetch('/api/install-requirements');
                const data = await response.json();

                resultArea.innerHTML = `<div class="alert ${data.success ? 'alert-success' : 'alert-danger'}">
                    <i class="fas ${data.success ? 'fa-check-circle' : 'fa-exclamation-circle'} me-2"></i>
                    ${data.message}
                </div>`;
            } catch (error) {
                resultArea.innerHTML = `<div class="alert alert-danger">
                    <i class="fas fa-exclamation-circle me-2"></i>
                    Error: ${error.message}
                </div>`;
            } finally {
                loading.style.display = 'none';
            }
        }

        async function scanTarget() {
            const target = document.getElementById('scanTarget').value;
            if (!target) {
                alert('Please enter a target');
                return;
            }

            const resultArea = document.getElementById('result');
            const loading = document.querySelector('.loading');

            loading.style.display = 'block';
            resultArea.innerHTML = '';

            try {
                const response = await fetch('/api/scan-target', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ target }),
                });
                const data = await response.json();
                resultArea.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (error) {
                resultArea.innerHTML = `<div class="alert alert-danger">Error: ${error.message}</div>`;
            } finally {
                loading.style.display = 'none';
            }
        }

        async function sshConnect() {
            const hostname = document.getElementById('sshHost').value;
            const username = document.getElementById('sshUser').value;
            const password = document.getElementById('sshPass').value;
            const key_filename = document.getElementById('sshKey').value;

            if (!hostname || !username) {
                alert('Please enter hostname and username');
                return;
            }

            const resultArea = document.getElementById('result');
            const loading = document.querySelector('.loading');

            loading.style.display = 'block';
            resultArea.innerHTML = '';

            try {
                const response = await fetch('/api/ssh-connect', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        hostname,
                        username,
                        password: password || undefined,
                        key_filename: key_filename || undefined,
                    }),
                });
                const data = await response.json();
                resultArea.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (error) {
                resultArea.innerHTML = `<div class="alert alert-danger">Error: ${error.message}</div>`;
            } finally {
                loading.style.display = 'none';
            }
        }
    </script>
</body>
</html>
